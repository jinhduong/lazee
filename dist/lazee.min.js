!function(){"use strict";var f={ENTER:13,SUGGESSTION_CLASS:"lazee-suggestion",DOWN:40,UP:38,SELFPROP:"__lazee",ESC:27};function p(n){setTimeout(function(){var e=n.querySelectorAll("."+f.SUGGESSTION_CLASS)[0];e&&(e.style.display="none"),n.classList.remove("open")},100)}function v(e,n){return n.displayProp?e[n.displayProp]:e}window.Lazee=function(e,n){if(!n.getData)throw Error("You need to define getData function");n=Object.assign({debounceTime:50,wordLen:1},n||{});var t=document.querySelectorAll(e);if(!t)throw new Error("The select ["+e+"] is empty ");var o=t[0];o.classList.add("lazee");var a,r,c,s,d,l=(a=o,r=n,s=document.createElement("input"),d=-1,s.onfocus=function(){r.onfocus&&r.onfocus(this)},s.onblur=function(){r.outfocus&&r.outfocus(this),a.classList.remove("open"),p(a)},s.addEventListener("keyup",function(n,t,o){var l,i,u,a,r;function c(){var e=Date.now()-a;e<t&&0<=e?l=setTimeout(c,t-e):(l=null,o||(r=n.apply(u,i),u=i=null))}void 0===o&&(o=!1),null==t&&(t=100);var e=function(){u=this,i=arguments,a=Date.now();var e=o&&!l;return l||(l=setTimeout(c,t)),e&&(r=n.apply(u,i),u=i=null),r};return e.clear=function(){l&&(clearTimeout(l),l=null)},e.flush=function(){l&&(r=n.apply(u,i),u=i=null,clearTimeout(l),l=null)},e}(function(e){if(e.preventDefault(),e.keyCode!==f.DOWN&&e.keyCode!==f.UP&&e.keyCode!==f.ENTER){e.keyCode===f.ESC&&p(a);var n,t=s.value;if(r.typing&&r.typing(t,e),r.getData){var o=r.getData(t);!(n=o)||"object"!=typeof n&&"function"!=typeof n||"function"!=typeof n.then?l(o):o.then(function(e){return l(e)})}}function l(e){d=-1,a.classList.add("open"),t.length>=r.wordLen&&function(e,n,t,o){var l=e.querySelectorAll("."+f.SUGGESSTION_CLASS)[0];if(l)l.style.display&&(l.style.display=null),function(e){for(;e.hasChildNodes();)e.removeChild(e.firstChild)}(l);else{var i=document.createElement("div");i.classList.add("lazee-suggestion"),l=i,e.appendChild(i)}var u,a,r,c,s=(u=n,a=t,r=o,c=document.createElement("ul"),a.forEach(function(n){var e=document.createElement("li"),t=document.createElement("a");e.addEventListener("click",function(e){e.preventDefault(),u.itemClick&&u.itemClick(n),r(n)}),u.displayProp&&(t.text=n[u.displayProp]),e[f.SELFPROP]=n,e.appendChild(t),c.appendChild(e)}),c);l.appendChild(s)}(a,r,e,function(e){s.value=v(e,r)})}},r.debounceTime)),s.addEventListener("keydown",function(e){if(e.keyCode===f.ENTER){var n=s.value;r.enter&&r.enter(n,e),c&&(s.value=v(c,r),p(a))}else if(e.keyCode===f.DOWN||e.keyCode===f.UP){var t=e.keyCode===f.DOWN;o=d,l=t,i=function(e){c=e,s[f.SELFPROP]=e},(u=a.querySelectorAll("."+f.SUGGESSTION_CLASS+" li"))&&(0<=o||-1===o&&l)&&o<=u.length-1&&(l&&o<u.length-1?o++:!l&&0<o&&o--,u.forEach(function(e){return e.classList.remove("sl")}),u[o]&&u[o].classList.add("sl"),i&&i(u[o][f.SELFPROP])),d=o}var o,l,i,u}),a.appendChild(s),s);return{value:function(){return l.value},item:function(){return l[f.SELFPROP]}}}}();
