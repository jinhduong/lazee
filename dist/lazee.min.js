!function(){"use strict";var f={ENTER:13,SUGGESSTION_CLASS:"lazee-suggestion",DOWN:40,UP:38,SELFPROP:"__lazee",ESC:27};function p(n){setTimeout(function(){var e=n.querySelectorAll("."+f.SUGGESSTION_CLASS)[0];e&&(e.style.display="none"),n.classList.remove("open")},100)}function v(e,n){return n.displayProp?e[n.displayProp]:e}window.Lazee=function(e,n){n=Object.assign({debounceTime:50,wordLen:1},n||{});var t=document.querySelectorAll(e);if(!t)throw new Error("The select ["+e+"] is empty ");var o=t[0];o.classList.add("lazee");!function(u,r){var c=document.createElement("input");c.onfocus=function(){r.onfocus&&r.onfocus(this)},c.onblur=function(){r.outfocus&&r.outfocus(this),u.classList.remove("open"),p(u)},c.addEventListener("keyup",function(n,t,o){var l,i,a,u,r;function c(){var e=Date.now()-u;e<t&&0<=e?l=setTimeout(c,t-e):(l=null,o||(r=n.apply(a,i),a=i=null))}void 0===o&&(o=!1),null==t&&(t=100);var e=function(){a=this,i=arguments,u=Date.now();var e=o&&!l;return l||(l=setTimeout(c,t)),e&&(r=n.apply(a,i),a=i=null),r};return e.clear=function(){l&&(clearTimeout(l),l=null)},e.flush=function(){l&&(r=n.apply(a,i),a=i=null,clearTimeout(l),l=null)},e}(function(e){if(e.preventDefault(),e.keyCode!==f.DOWN&&e.keyCode!==f.UP&&e.keyCode!==f.ENTER){e.keyCode===f.ESC&&p(u);var n,t=c.value;if(r.typing&&r.typing(t,e),r.getData){var o=r.getData(t);!(n=o)||"object"!=typeof n&&"function"!=typeof n||"function"!=typeof n.then?l(o):o.then(function(e){return l(e)})}}function l(e){u.classList.add("open"),t.length>=r.wordLen&&function(e,n,t,o){var l=e.querySelectorAll("."+f.SUGGESSTION_CLASS)[0];if(l)l.style.display&&(l.style.display=null),function(e){for(;e.hasChildNodes();)e.removeChild(e.firstChild)}(l);else{var i=document.createElement("div");i.classList.add("lazee-suggestion"),l=i,e.appendChild(i)}var a,u,r,c,s=(a=n,u=t,r=o,c=document.createElement("ul"),u.forEach(function(n){var e=document.createElement("li"),t=document.createElement("a");e.addEventListener("click",function(e){e.preventDefault(),a.itemClick&&a.itemClick(n),r(n)}),a.displayProp&&(t.text=n[a.displayProp]),e[f.SELFPROP]=n,e.appendChild(t),c.appendChild(e)}),c);l.appendChild(s)}(u,r,e,function(e){c.value=v(e,r)})}},r.debounceTime));var s,d=-1;c.addEventListener("keydown",function(e){if(e.keyCode===f.ENTER){var n=c.value;r.enter&&r.enter(n,e),s&&(c.value=v(s,r),p(u))}else if(e.keyCode===f.DOWN||e.keyCode===f.UP){var t=e.keyCode===f.DOWN;o=d,l=t,i=function(e){return s=e},(a=u.querySelectorAll("."+f.SUGGESSTION_CLASS+" li"))&&(0<=o||-1===o&&l)&&o<=a.length-1&&(l&&o<a.length-1?o++:!l&&0<o&&o--,a.forEach(function(e){return e.classList.remove("sl")}),a[o]&&a[o].classList.add("sl"),i&&i(a[o][f.SELFPROP])),d=o}var o,l,i,a}),u.appendChild(c)}(o,n)}}();
